$(document).ready(function(){var a={},b;$("#name").autocomplete({minLength:1,source:function(e,c){var d=e.term;if(d in a){c(a[d]);return}b=$.getJSON(yyBaseurl+"/setting/member/ajaxsearch",e,function(g,f,h){a[d]=g;if(h===b){c(g)}})}});$("a[class^='edit_']").hide();$("div.treeHovera").live({mouseover:function(){$(this).addClass("blueBg treeHoverLink fontB");$(this).children("a[class^='edit_']").show()},mouseout:function(){$(this).removeClass("blueBg treeHoverLink fontB");$(this).children("a[class^='edit_']").hide()}});$(".minus1,.minus2,.minus3").live("click",function(){FunToggle($(this),0,"",null,null)});$(".plus1,.plus2,.plus3").live("click",function(){var c=$(this).prevAll("img").length+2;if($(this).closest("aside").attr("id")=="addTreeBox"){FunToggle($(this),1,1,null,"TreeDeep_"+c,"addTreeDiv")}else{FunToggle($(this),1,"",null,"TreeDeep_"+c)}});$(".linkfocus").live("click",function(){if($(this).parent().hasClass("addTreeDiv")){return}FunGetMemeber($(this))});$("#clearParent").live("click",function(){$("#parent_id").val($(this).attr("data"));$(".parent_id").val($(this).attr("title"));toggleTreeBox("close")});$("#openAll").bind("click",function(){$("h2").children("span").attr("class","zhankai");$(".treeListIn").show()});$("#closeAll").bind("click",function(){$("h2").children("span").attr("class","zhedie");$(".treeListIn").hide()});$("h2.treeDept").live("click",function(){var d=$(this).parent().nextAll("section");var c=$(this).children("span").attr("class")=="zhankai"?"zhedie":"zhankai";if(c=="zhankai"){d.remove();FunGetSubMemeber($(this));d.hide()}$(this).next("div").toggle();$(this).children("span").attr("class",c);d.toggle()});$("#btn_setLeader").fancybox({modal:true,onComplete:function(){$(".zzjg_szfzr").find("tr").live("click",function(){$(this).css("background","#d5d5d5");$("#hidden_uid").val($(this).attr("data"))});$("#btn_setleaduid").live("click",function(){YY.util.ajaxApi(YY.util.url("/setting/dept/setleaduid/"),function(e,c){if(e&&e.rs){$.yy.rscallback("操作成功！");$.fancybox.close()}else{$.yy.rscallback(e.error)}},"POST","JSON","id="+$("#hidden_deptid").val()+"&leaduid="+$("#hidden_uid").val())})}});$("input[name='rtype']").bind("click",function(){var c=$(this).attr("value");if(c==1){window.location.href=yyBaseurl+"/setting/dept/index/rtype/1"}else{window.location.href=yyBaseurl+"/setting/dept/index/"}});$("div.addTreeDiv").live("click",function(){var c=$(this);$("#parent_id").val(c.attr("dept_id"));$(".parent_id").val(c.children("a").first().attr("title"));toggleTreeBox("close")});$("#createSubSpaceBtn,a.btn_close").live("click",function(){toggleTreeBox($(this).attr("data"))});$("a#selectParentBtn").fancybox({titleShow:false,showCloseButton:false,centerOnScroll:true,overlayOpacity:0.9,hideOnOverlayClick:false});$("a#tree,a#mechanism").live("click",function(){var c=$(this);$.fancybox({titleShow:false,showCloseButton:false,centerOnScroll:true,overlayOpacity:0.9,href:yyBaseurl+"/setting/dept/add/id/"+c.attr("data")+"/type/"+c.attr("type"),hideOnOverlayClick:false});return false});$("a.lockUser").fancybox({width:530,height:300,type:"iframe"});$(".edit_del").live("click",function(){var c=$(this).closest("div").attr("dept_id");YY.util.ajaxApi(yyBaseurl+"/setting/dept/confirmdel/",function(e){if(e.rs===false){if(e.error==1){$.yy.rscallback("该部门下含有员工，不能删除",1)}else{if(e.error==2){if(confirm("该部门下有子部门，删除该部门则其下子部门也被删除，确定要删除吗?")){location.href=yyBaseurl+"/setting/dept/delete/id/"+c+"/con/1"}}}}else{if(confirm("确定要删除吗")){location.href=yyBaseurl+"/setting/dept/delete/id/"+c+"/con/1"}}},"GET","json",{deptId:c})})});function checkSubmit(){var b=$("#dept_type").val();var a=b==1?"机构":"部门";if($("#deptname").val()==""){alert(a+"名称必填！");$("#deptname").focus();return false}if(b==1){if($("#sub_name").val==""){$("#sub_name").focus();alert(a+"简称必填")}}if($("#message").val()==""){alert(a+"简介必填！");$("#message").focus();return false}}function toggleTreeBox(a){if(a=="close"){$("#addTreeBox").hide();$("#addTreeBox").parent().css("width","462px");$("#fancybox-content").css("width","462px");$("#fancybox-wrap").css("width","482px");if($("#closeFancybox").length>0){$.fancybox.close()}if($("#parent_id").val()==0&&$("#assignSubmit").length>0){$("#assignSubmit").attr("disabled",true).removeClass("blueButton").addClass("darkGrayButton")}else{$("#assignSubmit").attr("disabled",false).removeClass("darkGrayButton").addClass("blueButton")}}else{$("#addTreeBox").parent().css("width","746px");$("#fancybox-content").css("width","746px");$("#fancybox-wrap").css("width","766px");$("#addTreeBox").css("height",$(".leftTree").height()+"px");$("#addTreeBox").show()}};