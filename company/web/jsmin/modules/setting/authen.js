$(document).ready(function(){$("#baseForm").validate({hasIco:false,rules:{name:{required:true,remote:{url:yyBaseurl+"/setting/base/qznamevalid",type:"GET",dataType:"json",data:{name:function(){return encodeURIComponent($("#name").val())},rid:function(){return Math.random()}}}},short_name:{required:true},contactor:{required:true}},messages:{name:{required:"请输入空间名称",remote:"空间名称已存在"},short_name:{required:"请输入空间简称"},contactor:{required:"请输入企业联系人姓名"}},errorClass:"error",errorPlacement:function(d,e){if(d.html()!=""){d.insertAfter(e);d.attr("id","lab_"+e.attr("name"));d.next().remove();e.removeClass("error")}}});$("#authenForm").validate({hasIco:false,rules:{companyName:{required:true},shortName:{required:true},userName:{required:true},email:{required:true,email:true},telphone:{required:true}},messages:{companyName:{required:"请输入公司名称"},shortName:{required:"请输入姓名"},userName:{required:"请输入企业联系人姓名"},email:{required:"请输入邮箱",email:"请输入正确的email地址"},telphone:{required:"请输入办公电话"}},errorClass:"error",errorPlacement:function(d,e){if(d.html()!=""){d.insertAfter(e);d.attr("id","lab_"+e.attr("name"));d.next().remove();e.removeClass("error")}}});$("#upload").change(function(){onUploadImgChange(this)});$("#preview").load(function(){onPreviewLoad(this)});$("a.settingQzLogo").fancybox();YY.util.loadScript(["modules/space/yy.avatar2.js"],{fn:function(){$("a.settingQzLogo").fancybox({width:730,height:500,centerOnScroll:true,hideOnOverlayClick:false,showCloseButton:false,onComplete:function(){var d=new YY.Avatar({aspectRatio:0,boxWidth:400,boxHeight:400,minSize:[48,48],bgColor:"black",bgOpacity:0.6},{button_placeholder_id:"logoUploadButton",upload_url:YY.util.url("/setting/base/uploadlogo")},{previews:{"#avatarMiddle":[160,160],"#avatarSmall":[48,48]}});d.bindEvents()}})}});$.yy.defaultText({inviteName:"请输入姓名或者邮箱"});$("#inviteName").yyautocomplete({appendTo:"#invite_div",ajaxUrl:url("/common/search/ccnotice"),selAppendTo:"#invite_list",select:function(d,e){}});$("input[name='inviteSubForm']").bind("click",function(){$("#invite_list li.rcAddmenListli").length>0?$(this).closest("form").submit():""});$(".settingBaseAdminsDel").live("click",function(){if(confirm("您确定要删除么？")){$(this).closest("ul").remove()}});$(".validateForm").validate({hasIco:false,rules:{name:{required:true,remote:{url:yyBaseurl+"/setting/base/qznamevalid",type:"GET",dataType:"json",data:{name:function(){return encodeURIComponent($("#name").val())},rid:function(){return Math.random()}}}},short_name:{required:true}},messages:{name:{required:"请输入空间名称",remote:"空间名称已存在"},short_name:{required:"请输入空间简称"}},errorClass:"error",errorPlacement:function(d,e){if(d.html()!=""){d.insertAfter(e);d.attr("id","lab_"+e.attr("name"));d.next().remove();e.removeClass("error")}}});$(".createSubSpaceBtn").live("click",function(){var d=$(this);$.fancybox({href:$(d).attr("href"),onComplete:function(){$("a[class^='edit_']").hide();$(".plus1,.plus2,.plus3").live("click",function(){var e=$(this).prevAll("img").length+2;FunToggle($(this),1,3,null,"CompanyDeep_"+e)});$(".minus1,.minus2,.minus3").live("click",function(){FunToggle($(this),0,3,null,null)});$("div.treeHovera").live("mouseover mouseout",function(e){if(e.type=="mouseover"){$(this).addClass("blueBg treeHoverLink");$(this).find("a[class^='edit_']").show()}else{$(this).removeClass("blueBg treeHoverLink");$(this).find("a[class^='edit_']").hide()}})}});return false});$(".linkfocus").live("click",function(){$("#sid").val($(this).attr("data"));$("#parentName").val($(this).attr("title"));$.fancybox.close()});var b=function(){var d=this;this.classID=".setting";this.defaultText="";this.init=function(){$(this.classID+"_input").bind("click",function(){$(this).val()==d.defaultText?$(this).val(""):""}).bind("blur",function(){$(this).val()==""?$(this).val(d.defaultText):""})};this.addEmailDomain=function(){$(this.classID+"_btn").bind("click",function(){var e=$(d.classID+"_input").val();var f='<li class="clearfix"><input type="hidden" name="emaildomain_allowed[]" value="'+e+'" /><span>'+e+'</span><a href="javascript:;" class="fr emailDomain_del">×</a></li>';if(e!=""&&e!=d.defaultText){$(d.classID+"_input").val("");$(d.classID+"_ul").append(f)}})};this.removeEmailDomain=function(){$(this.classID+"_del").live("click",function(){$(this).parent().remove()})}};var c=function(){var d=$(".settingPublicListTree");if(d.length){d.find(".plus1,.plus2,.plus3").live("click",function(){console.log(33333333333333332);var e=$(this).prevAll("img").length+2;FunToggle($(this),1,3,null,"CompanyDeep_"+e)});d.find(".minus1,.minus2,.minus3").live("click",function(){FunToggle($(this),0,3,null,null)});d.find("div.treeHovera").live("mouseover mouseout",function(e){if(e.type=="mouseover"){$(this).addClass("blueBg treeHoverLink");$(this).find("a[class^='edit_']").show()}else{$(this).removeClass("blueBg treeHoverLink");$(this).find("a[class^='edit_']").hide()}});d.find(".linkfocus").live("click",function(){var e=$(this).attr("data");YY.util.ajaxApi(yyBaseurl+"/setting/sns/getsubspace",function(f){$(".settingSubSpaceList").html(f);$(".settingAddPublicSpace").attr("data",e)},"post","html",{sid:e})})}$(".ajaxPage a").live("click",function(){url=$(this).attr("href");if(url){YY.util.ajaxApi(url,function(e){$(".settingSubSpaceList").html(e)},"post","html")}return false});$(".yy-domain-del","#domainContainter").live("click",function(){$(this).parent("li").remove()});$("#net_logo").change(function(){onUploadImgChange(this,"net")});$(".settingAddPublicSpace").live("click",function(){var e=$(this);$.fancybox({modal:true,transitionIn:"elastic",transitionOut:"elastic",href:yyBaseurl+"/setting/sns/addnet/pid/"+e.attr("data"),onComplete:function(){$("#addDomainBtn").live("click",function(){var h=$("#emaildomainInput");var f=$.trim(h.val());if(f==""){return false}var g=false;$('input[name="domainArr[]"]').each(function(){if($(this).val()==f){g=true;return false}});if(g){return false}$('<li class="clearfix"><span>'+f+'</span><a class="yy-domain-del fr" href="###">× </a><input type="hidden" name="domainArr[]" value="'+f+'" /></li>').appendTo("#domainContainter");h.val("").focus();return false});$("#netForm").validate({validClass:"icoRighttk",errorClass:"icoWrongtk",errorBg:"yellowBg",hasIco:false,rules:{net_name:{required:true,remote:{url:yyBaseurl+"/space/ajax/checkName",type:"GET",dataType:"json",data:{net_name:function(){return encodeURIComponent($("#net_name").val())},rid:function(){return Math.random()}}}},net_short_name:{required:true},net_description:{required:true,checkLength:200},net_logo:{required:true}},messages:{net_name:{required:"请输入社区名",remote:"社区名不可用"},net_short_name:{required:"请输入社区简称"},net_logo:{required:"请上传社区封面"},net_description:{required:"请输入社区简介"}}})}})})};var a=new b();a.classID=".emailDomain";a.defaultText="添加域名";a.init();a.addEmailDomain();a.removeEmailDomain();var c=new c();jQuery.validator.addMethod("checkLength",function(h,g,j){var k=0,d=h.length,e=-1;for(var f=0;f<d;f++){e=h.charCodeAt(f);if(e>=0&&e<=128){k+=1}else{k+=2}}if(e>=0&&e<=128){}else{j*=2}if(k>j){return false}return true},"长度超过200字")});