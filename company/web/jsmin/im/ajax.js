function InitAjax(){var a=false;if(window.XMLHttpRequest){a=new XMLHttpRequest();if(a.overrideMimeType){a.overrideMimeType("text/xml")}}else{if(window.ActiveXObject){try{a=new ActiveXObject("Msxml2.XMLHTTP")}catch(b){try{a=new ActiveXObject("Microsoft.XMLHTTP")}catch(b){}}}}if(!a){window.alert("不能创建XMLHttpRequest对象实例.");return false}return a}function im_ajax(url,action,data,callback,type,async){if(!url){return false}if(!action){action="get"}if(!callback){callback=ajaxCallback}if(!type){type="text"}if(async!="false"){async=true}action=action.toLowerCase();type=type.toLowerCase();var ajaxmessageid=document.getElementById("ajaxmessageid");if(ajaxmessageid){ajaxmessageid.style.display=""}var xmlhttp=InitAjax();xmlhttp.open(action,url,async);xmlhttp.setRequestHeader("x-requested-with","XMLHttpRequest");xmlhttp.setRequestHeader("Content-Type","application/x-www-form-urlencoded");xmlhttp.onreadystatechange=function(){if(xmlhttp.readyState==4&&xmlhttp.status==200){var returndata="";if(type=="json"){returndata=eval("("+xmlhttp.responseText+")")}else{if(type=="xml"){returndata=xmlhttp.responseXML}else{returndata=xmlhttp.responseText}}callback(returndata);if(ajaxmessageid){ajaxmessageid.style.display="none"}}};xmlhttp.send(data)};