$(document).ready(function(){var a=$('input[type="radio"][name="dbpublic"]');a.bind("click",function(){var c=YY.util.url("/images/data_pic_bur.gif");var d=YY.util.url("/images/data_pic.gif");var b=($(this).val()==0)?1:0;$("#selected_"+$(this).val()).attr("src",d);$("#selected_"+b).attr("src",c)});$("#dbTestBtn").bind("click",function(){YY.util.ajaxApi(yyBaseurl+"/setting/base/dbtest/",function(b){if(b.rs){$("#dbTestResult").removeClass("hidden")}else{$("#dbTestResult").addClass("hidden");alert(b.error)}},"POST","json",{dbhost:$("#dbhost").val(),dbuname:$("#dbuname").val(),dbport:$("#dbport").val(),dbname:$("#dbname").val(),dbpwd:$("#dbpwd").val(),dbtype:$("#dbtype").val()})});$("#subApplyBtn").bind("click",function(){DbConfig.validDbConnection(DbConfig.submit);return false})});var DbConfig={submit:function(){YY.util.ajaxApi(YY.util.url("/setting/base/dbsub/"),function(a){if(a.rs){$.yy.rscallback("申请提交成功，等待审核！");$("#proccessBtn").removeClass("grayButton2").addClass("blueButton");$("#subApplyBtn").removeClass("blueButton").addClass("grayButton2");$("#subApplyBtn").unbind("click")}else{$("#dbTestResult").addClass("hidden");alert(a.error)}},"POST","json",{dbhost:$("#dbhost").val(),dbuname:$("#dbuname").val(),dbport:$("#dbport").val(),dbname:$("#dbname").val(),dbpwd:$("#dbpwd").val(),dbtype:$("#dbtype").val(),ispub:$('input[name="dbpublic"]:checked').val()})},validDbConnection:function(a){YY.util.ajaxApi(YY.util.url("/setting/base/dbtest/"),function(b){if(b.rs){$("#dbTestResult").removeClass("hidden");if(typeof(a)=="function"){a()}}else{$("#dbTestResult").addClass("hidden");alert(b.error)}},"POST","json",{dbhost:$("#dbhost").val(),dbuname:$("#dbuname").val(),dbport:$("#dbport").val(),dbname:$("#dbname").val(),dbpwd:$("#dbpwd").val(),dbtype:$("#dbtype").val()})}};