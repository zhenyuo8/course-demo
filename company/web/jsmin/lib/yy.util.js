var YY=YY||{};YY.util={debug:YY_DEBUG_MODE,jsDir:YY_JS_DIR,trace:function(a){if(window.console&&window.console.log){console.log(a)}},url:function(b){if(typeof b!=="string"){return}if(typeof url==="function"){return url(b)}var a="http://"+window.location.host;return(b.lastIndexOf(".")!==-1)?a+url:a+"/cjt"+url},pageUrl:function(b,c){var a=this.url(YY.pageUrl[b]);a=a.format(c);return a},ajaxApi:function(b,c){if(typeof c!=="function"){return false}var d=this,a=arguments.length,g=a>2?arguments[2]:"",h=a>3?arguments[3]:"",e=a>4?arguments[4]:{};e.ajaxsubmit=1;var f=$.ajax({async:true,type:(g?g:"post"),url:b,cache:true,data:e,dataType:(h?h:"html"),success:function(j,i){c(j,i);d.imgLoadError()},error:function(i,k,j){}});return f},ajax:function(g){var c=g.target||null,a=g.url||"",f=g.data||{},j=g.success||function(){},h=g.error||function(){},i=j,e=h;if(c){var b=$("#yy_cover_button");if(c[0].tagName=="INPUT"&&c.attr("type")=="text"){c.css("color","#d2d2d2");i=function(l,k){j(l,k);c.css("color","#333333")};e=function(k,m,l){h(k,m,l);c.css("color","#333333")}}if(c[0].tagName=="INPUT"&&c.attr("type")=="button"||c.tagName=="BUTTON"||c.attr("type")=="submit"||c.attr("type")=="SUBMIT"){var d=c.offset();b.show();b.css({top:d.top,left:d.left});i=function(l,k){j(l,k);b.hide()};e=function(k,m,l){h(k,m,l);b.hide()}}}return $.ajax({type:g.type||"GET",async:g.async===false?false:(g.async||true),url:a,cache:g.cache||true,data:f,dataType:g.dataType||"json",success:i,error:e})},loadScript:function(a,b){typeof loadScript==="function"&&loadScript(a,b);return},initUploaded_flag:false,initUpload:function(c){var b=this,a=b.debug?["plugin/swfupload/swfupload.js","plugin/swfupload/swfupload.queue.js","lib/upload/yy.upload.handlers.js"]:["upload.js"];if(b.initUploaded_flag){typeof c==="function"&&c();return}b.loadScript(a,{fn:function(){b.initUploaded_flag=true;typeof c==="function"&&c()}})},imgLoadError:function(){$("img").one("error",function(){var a=$(this);setTimeout(function(){var b=a.attr("errordata"),c=a.attr("rel");if(c||b){c&&a.attr("src",c);b&&a.parent().addClass(b).html("")}},10)})},isIE:function(){return !-[1,]},isIE6:function(){var a=this;return !!(a.isIE()&&!window.XMLHttpRequest)},formatCookieField:function(a){return"YY"+a},addCookie:function(e,a,d){e=this.formatCookieField(e);var f=e+"="+escape(a);if(d>0){var c=new Date();var b=d*3600*1000;c.setTime(c.getTime()+b);f+="; expires="+c.toGMTString()}document.cookie=f},getCookie:function(c){c=this.formatCookieField(c);var d=document.cookie.split("; ");for(var b=0;b<d.length;b++){var a=d[b].split("=");if(a[0]==c){return unescape(a[1])}}},delCookie:function(b){b=this.formatCookieField(b);var a=new Date();a.setTime(a.getTime()-10000);document.cookie=b+"=a; expires="+a.toGMTString()},strWrap:function(a){a=a.replace(/\r\n/ig,"<br/>");a=a.replace(/\r/ig,"<br/>");a=a.replace(/ /ig,"&nbsp;");return a},keyEnable:function(a){if($.browser.mozilla&&(a==173||a==61)){return true}if(!((a>=65&&a<=90)||(a>=48&&a<=57)||(a>=186&&a<=192)||(a>=219&&a<=222)||(a>=96&&a<=109)||a==32)&&a!=8){return false}else{return true}},selected:function savePos(e){var a=0,f=0;if(typeof(e.selectionStart)=="number"){f=e.selectionStart;a=e.selectionEnd}else{if(document.selection){var b=document.selection.createRange();if(b.parentElement().id==e.id){var c=document.body.createTextRange();c.moveToElementText(e);for(f=0;c.compareEndPoints("StartToStart",b)<0;f++){c.moveStart("character",1)}for(var d=0;d<=f;d++){if(e.value.charAt(d)=="/n"){f++}}var c=document.body.createTextRange();c.moveToElementText(e);for(a=0;c.compareEndPoints("StartToEnd",b)<0;a++){c.moveStart("character",1)}for(var d=0;d<=a;d++){if(e.value.charAt(d)=="/n"){a++}}}}}return{start:f,end:a}},setSelected:function(b,d,c){if(b.setSelectionRange){b.setSelectionRange(d,c)}else{if(b.createTextRange){var a=b.createTextRange();a.collapse(true);a.moveStart("character",d);a.moveEnd("character",c-d-1);a.select()}}b.focus()},textLength:function(a){if($.type(a)!=="string"){return}return Math.floor(a.len())},removeHTMLTag:function(a){a=a.replace(/<\/?[^>]*>/g,"");a=a.replace(/[ | ]*\n/g,"");a=a.replace(/&nbsp;/ig,"");return a},extend:function(){var a=Object.prototype.constructor;return function(b,f){var c=f.prototype;var e=b.prototype;var d=function(){};d.prototype=c;e=b.prototype=new d();b.superclass=c;e.constructor=b;if(c.constructor==a){c.constructor=f}b.prototype.toString=f.prototype.toString;return b}}()};String.prototype.format=function(d){if(d!=null){var a=this;for(var b in d){var c=new RegExp("\\<\\%\\="+b+"\\%\\>","gi");a=a.replace(c,d[b]?(d[b]=="null"?"":d[b]):"")}}return a};String.prototype.len=function(){return this.replace(/[^x00-xff]/g,"aa").length};String.prototype.remove=function(d,c){var a=this.slice(0,d);var b=this.slice(d+c);return a+b};String.prototype.trim=function(){return this.replace(/(^ *)( *$)/g,"")};Date.prototype.format=function(f){var h=function(i){if(i.toString().length>1){return i.toString()}else{return"0"+i.toString()}};var d=this.getFullYear(),e=this.getMonth()+1,b=this.getDate(),a=this.getHours(),g=this.getMinutes(),c=this.getSeconds();f=f||"yyyy-MM-dd hh:mm:ss";return f.replace(/yyyy/,d).replace(/yy/,d.toString().substr(2,2)).replace(/MM/,h(e)).replace(/M/,e).replace(/dd/,h(b)).replace(/d/,b).replace(/hh/,h(a)).replace(/h/,a).replace(/mm/,h(g)).replace(/m/,g).replace(/ss/,h(c)).replace(/s/,c)};YY.pageUrl={topicPage:"/topic/topic/convs/topic_id/<%=topicId%>"};YY.range={rangeInstance:function(){try{var b=window.getSelection?window.getSelection():document.selection;var a=b.createRange?b.createRange():b.getRangeAt(0);return a}catch(c){}},insertHtmlAtCaret:function(b,a){var f,a;if(window.getSelection){f=window.getSelection();if(f.getRangeAt&&f.rangeCount){a=a;a.deleteContents();var c=document.createElement("div");c.innerHTML=b;var g=document.createDocumentFragment(),e,d;while((e=c.firstChild)){d=g.appendChild(e)}a.insertNode(g);if(d){a=a.cloneRange();a.setStartAfter(d);a.collapse(true);f.removeAllRanges();f.addRange(a)}}}else{if(document.selection&&document.selection.type!="Control"){document.selection.createRange().pasteHTML(b)}}},insertimg:function(i,b,a){document.getElementById(b).focus();var f=window.getSelection?window.getSelection():document.selection;var c=f.createRange?f.createRange():f.getRangeAt(0);if(!window.getSelection){c.pasteHTML(i);c.collapse(false);c.select()}else{YY.util.trace(c.startContainer);YY.util.trace(c.startOffset);c.collapse(false);var h=c.createContextualFragment(i);var d=h.lastChild;while(d&&d.nodeName.toLowerCase()=="br"&&d.previousSibling&&d.previousSibling.nodeName.toLowerCase()=="br"){var g=d;d=d.previousSibling;h.removeChild(g)}c.insertNode(h);if(d){c.setEndAfter(d);c.setStartAfter(d)}f.removeAllRanges();f.addRange(c)}return c.startContainer},getSelection:function(){if(window.getSelection){return window.getSelection()}return document.selection}};YY.log=function(c){var a=arguments.length;if(window.console&&window.console.log){for(var b=0;b<a;b++){console.log(arguments[b])}}};$.fn.extend({pressEnter:function(a){this.each(function(b,c){$(c).bind("keyup",function(d){var f=d.keyCode,e=false;if(f==13||f==32){var g=$.proxy(a,this);g(d)}return e})})},pressEsc:function(a){this.each(function(b,c){$(c).bind("keyup",function(d){var f=d.keyCode,e=false;if(f==27){var g=$.proxy(a,this);g(d)}return e})})},dbclick:function(a){var b=this;this.each(function(e,f){var c=false;var d=0;$(f).bind("click",function(h){var g=false;if(!c){c=true;setTimeout(function(){c=false},200)}else{var i=$.proxy(a,this);i(h)}return g})})},ctrlEnter:function(a){var b=this;var c=false;$(this).keydown(function(d){var e=d.keyCode;if(e==17){c=true}if(e==13&&c){$.proxy(a,b)(d)}});$(this).keyup(function(d){var e=d.keyCode;if(e==17){c=false}})}});