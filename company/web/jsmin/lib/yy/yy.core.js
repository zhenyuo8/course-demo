(function(d,b){d.yy=d.yy||{};d.fn.yy=d.fn.yy||{};d.extend(d.yy,{rscallback:function(f,e){d("#rscallback").show();d("#rscallback").html('<span class="'+(parseInt(e)>0?"icoWrongtk":"icoRighttk")+'">'+f+"</span>");if(parseInt(d(document).scrollTop())>parseInt(d("#rscallback").offset().top)){d("#rscallback").css("top",d(document).scrollTop())}setTimeout(function(){d("#rscallback").hide()},4000)}});d.extend(d.validator.defaults,{errorElement:"span",validClass:"icoRight",errorClass:"icoWrong",errorBg:"redBg",hasIco:true,success:function(e){var h="#"+e.attr("for");var g=this.hasIco?d(h).parent():d(h);if(d("#valid_"+e.attr("for")).html()==null){var f='<span id="valid_'+e.attr("for")+'" class="'+this.validClass+'"></span>';g.after(f)}e.replaceWith("");g.removeClass(this.errorBg)},errorPlacement:function(e,f){if(e.html()==""){return}var h=f.attr("id");var g=this.hasIco?f.parent():f;d("#valid_"+h).remove();g.addClass(this.errorBg);d("#"+h).parent().find("."+this.validClass).replaceWith("");g.after(e);e.attr("id","lab_"+h)}});d.extend(d.yy,{authpwd:function(f){var e=this;e.settings={id:"password",labid:"authpwd",defaultwidth:20,startlength:4};d.extend(e.settings,f);e.valid=function(){var g=d("#"+e.settings.id).val();if(g.length>=e.settings.startlength){if(/[a-zA-Z]+/.test(g)&&/[0-9]+/.test(g)&&/\W+\D+/.test(g)){e.noticeAssign(100)}else{if(/[a-zA-Z]+/.test(g)||/[0-9]+/.test(g)||/\W+\D+/.test(g)){if(/[a-zA-Z]+/.test(g)&&/[0-9]+/.test(g)){e.noticeAssign(50)}else{if(/\[a-zA-Z]+/.test(g)&&/\W+\D+/.test(g)){e.noticeAssign(50)}else{if(/[0-9]+/.test(g)&&/\W+\D+/.test(g)){e.noticeAssign(50)}else{e.noticeAssign(e.settings.defaultwidth)}}}}}}else{e.noticeAssign(e.settings.defaultwidth)}};e.noticeAssign=function(g){if(g>=0){d("#"+e.settings.labid).css("width",g+"%")}};e.noticeAssign(0);d("#"+e.settings.id).bind("keypress",e.valid)}});var c="_yy_dl";d.extend(d.yy,{defaultText:function(f){function g(i){var h=i;if(typeof(i)=="object"){h=i.attr("id")}return h+c}function e(m,j,h,i,l){j.on("click",function(){m.focus()});m.on({blur:function(){var n=d(this);if(d.trim(n.val())===""){n.val("");j.html(h)}else{j.html("")}l(m)},keydown:k,keyup:k,change:k});function k(){var n=d(this);!!n.val()?j.html(""):j.html(h)}}d.each(f,function(l,h){var k={txt:"请输入",css:"inputSpan",val:"",focus:function(){},blur:function(){}};if(typeof(h)=="string"){h={txt:h}}d.extend(k,h);var i=d("#"+l);if(typeof(i.attr("id"))=="undefined"){return}i.val(k.val);var j=g(l);d('<span id="'+j+'" class="'+k.css+'">'+k.txt+"</span>").insertBefore(i);e(i,d("#"+j),k.txt,k.focus,k.blur)})}});d.extend(d.yy,{comboDiv:function(g){var e=this,h='<span class="arrowDown"></span>';e.selected=function(j){var i=d(this).attr("id");var k=d(this).parent().attr("id");k=e.id(k,0,true);e.parameters[k].defaultid=e.id(i,2,true);d("#group").val(e.id(i,2,true));if(d("span.arrowDown","#"+e.id(k,1)).length>0){d("#"+e.id(k,1)).html(d(this).text()+h)}else{d("#"+e.id(k,1)).html(d(this).text())}d.each(d("#"+e.id(k,0)+" > a"),function(l,m){d(this).find("."+f).remove()});d('<span class="'+f+'" data="'+e.parameters[k].defaultid+'"></span>').appendTo(d(this));d("#"+e.id(k,0)).hide();e.parameters[k].callback(e.parameters[k].defaultid,e.parameters[k]);return false};e.settings={labelcss:"blueLink",defaultid:0,labelover:"cur",css:"tkBox c3a",data:[{id:0,title:"",txt:"选择",href:"###",css:"",ico:"",icotitle:""}],remote:false,selected:e.selected,firstrq:true,callback:function(){}};var f="icor";e.parameters={};e.id=function(l,j,i){var k=["aside_","label_","combo_list_"];if(i==true){return l.replace(k[j],"")}return k[j]+l};e.display=function(i,j){if(e.parameters[j].ajax){return false}if(d.trim(i.html())==""){d(e.createHtml(j)).appendTo(i)}if(typeof(d("#"+i.attr("id")+" > a").data("events"))=="undefined"){d("#"+i.attr("id")+" > a").bind("click",e.parameters[j].selected)}e.parameters[j].showFlag=true;i.show()};e.hide=function(i,j){setTimeout(function(){if(!e.parameters[j].showFlag){i.hide();e.parameters[j].showFlag=false}},100)};e.bindevent=function(j,i,k){j.on({mouseenter:function(m){var l=e.parameters[k];if(l!=="undefined"){d("#"+e.id(k,1)).addClass(l.labelover);if(l.remote){if(l.firstrq){l.ajax=true;l.firstrq=false;d.post(l.remote,[],function(n){l.ajax=false;l.data=n;e.display(i,k);typeof l.callback==="function"&&l.callback(n);return false},"json")}else{if(!l.ajax){e.display(i,k)}}}else{e.display(i,k)}}},mouseleave:function(m){var l=e.parameters[k];if(l!=="undefined"){d("#"+e.id(k,1)).removeClass(l.labelover);l.showFlag=false;e.hide(i,k)}}});i.on({mouseleave:function(m){var l=e.parameters[k];if(l!=="undefined"){d("#"+e.id(k,1)).removeClass(l.labelover);l.showFlag=false;e.hide(i,k)}}})};e.drawlist=function(l,j,i,k){if(e.parameters[l].ajax){return i}var j=k>=0?j[k]:j;d.each(j,function(m,n){i.push('<a id="'+e.id(n.id,2)+'" ');if(typeof(n.css)!="undefined"){i.push('class="'+n.css+'" ')}if(typeof(n.href)=="undefined"){n.href="###"}i.push('href="'+n.href+'" title="'+(typeof(n.title)=="string"?n.title:"")+'"><span class="fl">'+n.txt+"</span>");if(typeof(n.ico)!="undefined"){if(typeof(n.icotitle)=="undefined"){n.icotitle=""}i.push('<span class="'+n.ico+'">'+n.icotitle+"</span>")}if(m==e.val(l)){i.push('<span class="'+f+'"></span>')}i.push("</a>")});return i};e.createHtml=function(l){if(e.parameters[l].ajax){return""}var k=e.parameters[l].data;var j=new Array();if(e.parameters[l].h2 instanceof Array){for(var i=0;i<e.parameters[l].h2.length;i++){j.push("<h2>"+e.parameters[l].h2[i]+"</h2>");j=e.drawlist(l,k,j,i)}}else{if(typeof(e.parameters[l].h2)!="undefined"){j.push("<h2>"+e.parameters[l].h2+"</h2>");j=e.drawlist(l,k,j,-1)}else{j=e.drawlist(l,k,j,-1)}}return j.join("")};e.init=function(){d.each(g,function(l,i){if(typeof(e.parameters[l])!=="undefined"){return}var j=e.parameters[l]={showFlag:false,ajax:false};d.extend(j,e.settings,i);var k=j.callback;d('<a id="'+e.id(l,1)+'" class="'+j.labelcss+'" href="javascript:;">'+(typeof(j.title)==="undefined"?j.data[e.val(l)].txt:j.title)+h+"</a>").appendTo(d("#"+l));if(j.remote&&typeof(j.title)=="undefined"){d.post(j.remote,[],function(m){m=j.format(m);j.data=m;j.firstrq=false;d("#"+e.id(l,1)).html(m[0].txt+h);j.defaultid=m[0].id;typeof k==="function"&&k(m)},"json")}d('<aside id="'+e.id(l,0)+'" class="'+j.css+'"></aside>').appendTo(d("#"+l));d("#"+e.id(l,0)).hide();e.bindevent(d("#"+l),d("#"+e.id(l,0)),l)})};e.val=function(i){return typeof e.parameters[i]!=="undefined"?e.parameters[i].defaultid:0};e.init()}});d.extend(d.yy,{comboDiv1:function(g){var e=this,h='<span class="arrowDown"></span>';e.selected=function(j){var i=d(this).attr("id");var k=d(this).parent().attr("id");k=e.id(k,0,true);e.parameters[k].defaultid=e.id(i,2,true);d("#group").val(e.id(i,2,true));if(d("span.arrowDown","#"+e.id(k,1)).length>0){d("#"+e.id(k,1)).html(d(this).text()+h)}else{d("#"+e.id(k,1)).html(d(this).text())}d.each(d("#"+e.id(k,0)+" > a"),function(l,m){d(this).find("."+f).remove()});d('<span class="'+f+'" data="'+e.parameters[k].defaultid+'"></span>').appendTo(d(this));d("#"+e.id(k,0)).hide();e.parameters[k].callback(e.parameters[k].defaultid,e.parameters[k]);return false};e.settings={labelcss:"blueLink",defaultid:0,labelover:"cur",css:"tkBox c3a",data:[{id:0,title:"",txt:"",href:"###",css:"",ico:"",icotitle:""}],remote:false,selected:e.selected,firstrq:true,callback:function(){}};var f="icor";e.parameters={};e.id=function(l,j,i){var k=["aside_","label_","combo_list_"];if(i==true){return l.replace(k[j],"")}return k[j]+l};e.display=function(i,j){if(e.parameters[j].ajax){return false}if(d.trim(i.html())==""){d(e.createHtml(j)).appendTo(i)}if(typeof(d("#"+i.attr("id")+" > a").data("events"))=="undefined"){d("#"+i.attr("id")+" > a").bind("click",e.parameters[j].selected)}e.parameters[j].showFlag=true;i.show()};e.hide=function(i,j){setTimeout(function(){if(!e.parameters[j].showFlag){i.hide();e.parameters[j].showFlag=false}},100)};e.bindevent=function(j,i,k){j.on({mouseover:function(m){var l=e.parameters[k];if(l!=="undefined"){d("#"+e.id(k,1)).addClass(l.labelover);if(l.remote){if(l.firstrq){l.ajax=true;l.firstrq=false;d.post(l.remote,[],function(n){l.ajax=false;l.data=n;e.display(i,k);return false},"json")}else{if(!l.ajax){e.display(i,k)}}}else{e.display(i,k)}}},mouseout:function(m){var l=e.parameters[k];if(l!=="undefined"){d("#"+e.id(k,1)).removeClass(l.labelover);l.showFlag=false;e.hide(i,k)}},click:function(){return false}});i.on({mouseout:function(m){var l=e.parameters[k];if(l!=="undefined"){d("#"+e.id(k,1)).removeClass(l.labelover);l.showFlag=false;e.hide(i,k)}}})};e.drawlist=function(l,j,i,k){if(e.parameters[l].ajax){return i}var j=k>=0?j[k]:j;d.each(j,function(m,n){i.push('<a id="'+e.id(n.id,2)+'" ');if(typeof(n.css)!="undefined"){i.push('class="'+n.css+'" ')}if(typeof(n.href)=="undefined"){n.href="###"}i.push('href="'+n.href+'" title="'+(typeof(n.title)=="string"?n.title:"")+'"><span class="fl">'+n.txt+"</span>");if(typeof(n.ico)!="undefined"){if(typeof(n.icotitle)=="undefined"){n.icotitle=""}i.push('<span class="'+n.ico+'">'+n.icotitle+"</span>")}if(m==e.val(l)){i.push('<span class="'+f+'"></span>')}i.push("</a>")});return i};e.createHtml=function(l){if(e.parameters[l].ajax){return""}var k=e.parameters[l].data;var j=new Array();if(e.parameters[l].h2 instanceof Array){for(var i=0;i<e.parameters[l].h2.length;i++){j.push("<h2>"+e.parameters[l].h2[i]+"</h2>");j=e.drawlist(l,k,j,i)}}else{if(typeof(e.parameters[l].h2)!="undefined"){j.push("<h2>"+e.parameters[l].h2+"</h2>");j=e.drawlist(l,k,j,-1)}else{j=e.drawlist(l,k,j,-1)}}return j.join("")};e.init=function(){d.each(g,function(k,i){if(typeof(e.parameters[k])!=="undefined"){return}var j=e.parameters[k]={showFlag:false,ajax:false};d.extend(j,e.settings,i);d('<a id="'+e.id(k,1)+'" class="'+j.labelcss+'" href="javascript:;">'+(typeof(j.title)==="undefined"?j.data[e.val(k)].txt:j.title)+h+"</a>").appendTo(d("#"+k));if(j.remote&&typeof(j.title)=="undefined"){d.post(j.remote,[],function(l){l=j.format(l);j.data=l;j.firstrq=false;d("#"+e.id(k,1)).html(l[0].txt+h);j.defaultid=l[0].id},"json")}d('<aside id="'+e.id(k,0)+'" class="'+j.css+'"></aside>').appendTo(d("#"+k));d("#"+e.id(k,0)).hide();e.bindevent(d("#"+k),d("#"+e.id(k,0)),k)})};e.val=function(i){return typeof e.parameters[i]!=="undefined"?e.parameters[i].defaultid:0};e.init()}});d.extend(d.yy,{comboDiv2:function(g){var e=this,h='<span class="arrowDown"></span>';e.selected=function(j){var i=d(this).attr("id");var k=d(this).parent().attr("id");k=e.id(k,0,true);e.parameters[k].defaultid=e.id(i,2,true);d("#group").val(e.id(i,2,true));if(d("span.arrowDown","#"+e.id(k,1)).length>0){d("#"+e.id(k,1)).html(d(this).text()+h)}else{d("#"+e.id(k,1)).html(d(this).text())}d.each(d("#"+e.id(k,0)+" > a"),function(l,m){d(this).find("."+f).remove()});d('<span class="'+f+'" data="'+e.parameters[k].defaultid+'"></span>').appendTo(d(this));d("#"+e.id(k,0)).hide();e.parameters[k].callback(e.parameters[k].defaultid,e.parameters[k]);return false};e.settings={labelcss:"blueLink",defaultid:0,labelover:"cur",css:"tkBox c3a",data:[{id:0,title:"",txt:"选择",href:"###",css:"",ico:"",icotitle:""}],remote:false,selected:e.selected,firstrq:true,callback:function(){}};var f="icor";e.parameters={};e.id=function(l,j,i){var k=["aside_","label_","combo_list_"];if(i==true){return l.replace(k[j],"")}return k[j]+l};e.display=function(i,j){if(e.parameters[j].ajax){return false}if(d.trim(i.html())==""){d(e.createHtml(j)).appendTo(i)}if(typeof(d("#"+i.attr("id")+" > a").data("events"))=="undefined"){d("#"+i.attr("id")+" > a").bind("click",e.parameters[j].selected)}e.parameters[j].showFlag=true;i.show()};e.hide=function(i,j){setTimeout(function(){if(!e.parameters[j].showFlag){i.hide();e.parameters[j].showFlag=false}},100)};e.bindevent=function(j,i,k){j.on({mouseover:function(m){var l=e.parameters[k];if(l!=="undefined"){d("#"+e.id(k,1)).addClass(l.labelover);if(l.remote){if(l.firstrq){l.ajax=true;l.firstrq=false;d.post(l.remote,[],function(n){l.ajax=false;l.data=n;e.display(i,k);return false},"json")}else{if(!l.ajax){e.display(i,k)}}}else{e.display(i,k)}}},mouseout:function(m){var l=e.parameters[k];if(l!=="undefined"){d("#"+e.id(k,1)).removeClass(l.labelover);l.showFlag=false;e.hide(i,k)}}});i.on({mouseout:function(m){var l=e.parameters[k];if(l!=="undefined"){d("#"+e.id(k,1)).removeClass(l.labelover);l.showFlag=false;e.hide(i,k)}}})};e.drawlist=function(l,j,i,k){if(e.parameters[l].ajax){return i}var j=k>=0?j[k]:j;d.each(j,function(m,n){i.push('<a id="'+e.id(n.id,2)+'" ');if(m==e.val(l)){n.css=(typeof(n.css)!="undefined")?n.css+" cur":"cur"}if(typeof(n.css)!="undefined"){i.push('class="'+n.css+'" ')}if(typeof(n.href)=="undefined"){n.href="###"}i.push('href="'+n.href+'" title="'+(typeof(n.title)=="string"?n.title:"")+'">'+n.txt);if(typeof(n.ico)!="undefined"){if(typeof(n.icotitle)=="undefined"){n.icotitle=""}i.push('<span class="'+n.ico+'">'+n.icotitle+"</span>")}if(m==e.val(l)){i.push('<span class="'+f+'"></span>')}i.push("</a>")});return i};e.createHtml=function(l){if(e.parameters[l].ajax){return""}var k=e.parameters[l].data;var j=new Array();if(e.parameters[l].h2 instanceof Array){for(var i=0;i<e.parameters[l].h2.length;i++){j.push("<h2>"+e.parameters[l].h2[i]+"</h2>");j=e.drawlist(l,k,j,i)}}else{if(typeof(e.parameters[l].h2)!="undefined"){j.push("<h2>"+e.parameters[l].h2+"</h2>");j=e.drawlist(l,k,j,-1)}else{j=e.drawlist(l,k,j,-1)}}return j.join("")};e.init=function(){d.each(g,function(k,i){if(typeof(e.parameters[k])!=="undefined"){return}var j=e.parameters[k]={showFlag:false,ajax:false};d.extend(j,e.settings,i);d('<a id="'+e.id(k,1)+'" class="'+j.labelcss+'" href="javascript:;">'+(typeof(j.title)==="undefined"?j.data[e.val(k)].txt:j.title)+h+"</a>").appendTo(d("#"+k));if(j.remote&&typeof(j.title)=="undefined"){d.post(j.remote,[],function(l){l=j.format(l);j.data=l;j.firstrq=false;d("#"+e.id(k,1)).html(l[0].txt+h);j.defaultid=l[0].id},"json")}d('<aside id="'+e.id(k,0)+'" class="'+j.css+'"></aside>').appendTo(d("#"+k));d("#"+e.id(k,0)).hide();e.bindevent(d("#"+k),d("#"+e.id(k,0)),k)})};e.val=function(i){return typeof e.parameters[i]!=="undefined"?e.parameters[i].defaultid:0};e.init()}});d.extend(d.yy,{followCommon:function(g){var f=this;var e={setsId:"body",confirm:{txt:"加关注",css:"gzChengButton"},cancel:{txt:"取消关注",css:"gzGrayButton"},callback:function(h,i,j){},reload:true,followSelector:".yy-follow-common",batch:false,batchClass:"yy-follow-batch",checkBoxSelector:'input[name="member_id"]:checked'};d.extend(e,g);d(e.setsId).find(e.followSelector).live("click",function(){var i=d(this),h=0,j={status:h,type:i.attr("role"),id:i.attr("for")};if(i.hasClass(e.confirm.css)){j.status=1}if(e.batch&&i.hasClass(e.batchSelector)){j.id=[];d(e.checkBoxSelector).each(function(){j.id.push(d(this).val())});if(j.id.length==0){d.yy.rscallback("必须选择一项");return false}}d.post(yyBaseurl+"/space/ajax/follow",j,function(k){if(!k.rs){alert(k.error);return}i.toggleClass(e.confirm.css);i.toggleClass(e.cancel.css);var l="关注成功";if(j.status==0){l="已取消关注";i.html(e.confirm.txt);d.yy.rscallback(l)}else{i.html(e.cancel.txt);d.yy.rscallback(l)}e.callback(h,k,i)},"json");return false})},follow:function(g){var f=this;var e={setsId:"body",confirm:{txt:"加关注",css:"gzChengButton"},cancel:{txt:"取消关注",css:"gzGrayButton"},callback:function(h,i,j){},reload:true,followSelector:".yy-follow"};d.extend(e,g);d(e.setsId).find(e.followSelector).live("click",function(){var i=d(this);var l=i.attr("ele_role");var h=0;if(i.hasClass(e.confirm.css)){h=1}if(l=="file"){if(i.hasClass("confirm")){h=1}}if(typeof(d(this).attr("for"))!="undefined"){var j="/status/"+h+"/id/"+d(this).attr("for")+"/type/"+d(this).attr("role")}else{var k=[];d('input[name="member_id"]:checked').each(function(){k.push(d(this).val())});if(k.length==0){alert("必须选择一项");return false}var j="/status/"+h+"/id/"+k+"/type/"+d(this).attr("role")}d.post(yyBaseurl+"/space/ajax/follow"+j,"",function(o){if(!o.rs){alert(o.error);return}i.toggleClass(e.confirm.css);i.toggleClass(e.cancel.css);var p="关注成功";var n=i.attr("type");if(h==0){p="已取消关注";i.html(e.confirm.txt);i.parent().parent().find(".cyName").find("input").removeAttr("disabled").attr({value:i.attr("for"),name:"member_id",id:"member_id"});if(i.parent().attr("class")=="doBt pl13"){a=i.parent().find("a");i.parent().parent().html("").append(a);i.removeClass("gzGrayButton")}d.yy.rscallback(p);if(e.reload){location.reload()}}else{i.html(e.cancel.txt);if(l=="file"){}else{i.prev("input[type='checkbox']").hide();i.closest("li").find("input[type='checkbox']").attr("disabled","disabled");var m=yyBaseurl+"/followed/group/list/fid/"+i.attr("for");d.fancybox({href:m,margin:0,padding:0,autoScale:true,titleShow:false,showCloseButton:false,centerOnScroll:true,overlayOpacity:0.9,hideOnOverlayClick:true})}}e.callback(h,o,i)},"json");if(h==0){b.ajaxApi(b.url("/followed/group/ajaxcancel/"),function(n,m){if(n){}},"POST","json",{id:d(this).attr("for")})}return false})}});d.extend(d.yy,{mygroup:function(f,e){if(typeof(d.yy.groupData)=="undefined"){d.post(yyBaseurl+"/api/info/mygroup/substr/"+e,{},function(g){f(g)},"json")}else{f(d.yy.groupData)}}});d.fn.yyautoWrap=function(f){var i=d(this),k=i.css("line-height"),h=i.css("font-size"),e=d('<div id="'+(new Date().getTime())+'" style="display:none;font-size:'+h+";line-height:"+k+';"></div>'),g=i.height(),l="";i.css("overflow","hidden");e.css("width",i.css("width")).appendTo("body");i.on({keydown:j,keyup:j,change:j});function j(q){var o=i.val(),r=o.substring(0,f);if(o!==r||l!==r){var p=r.replace(/[<]/g,"&lt;").replace(/[>]/g,"&gt;").replace(/\n|\r|(\r\n)/g,"<br />");l=r;e.html(p);var n=parseInt(e.css("height"))+14,m=n<g?g:n;o===r?i.css("height",m+"px"):i.val(r).css("height",m+"px")}}};d.extend(d.yy,{checkAll:function(e){e.checkAllObj.live("click",function(){var f=d(this).attr("checked")=="checked"?true:false;if(f){e.checkboxObj.attr("checked","checked")}else{e.checkboxObj.removeAttr("checked");if(typeof(e.callback)!="undefined"){e.callback()}}})}});d(function(){d("#rscallback").bind("click",function(){d("#rscallback").hide();return false});d("input").blur(function(){var f=d(this);var e=f.attr("default");if(e==""){return}if(f.val()==""){f.val(e)}});d("input").focus(function(){var f=d(this);var e=f.attr("default");if(e==""){return}if(f.val()==e){f.val("")}})})})(jQuery,YY.util||{});