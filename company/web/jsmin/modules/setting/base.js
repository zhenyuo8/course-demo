function onUploadImgChange(f,a){var d=f.value;var n=d.substring(d.lastIndexOf(".")).toLowerCase();if(!checkFileExt(n)){alert("您上传的文件类型不合要求，请重新选择！");return}if(typeof(a)=="undefined"){a="preview"}var g=document.getElementById(a),l=document.getElementById(a+"_fake"),i=document.getElementById(a+"_size_fake");try{if(typeof FileReader!=="undefined"){var b=f.files[0];var c=b.fileSize||b.size;if(checkFileSize(c)){var j=new FileReader();j.readAsDataURL(b);j.onload=function(o){g.src=this.result}}}else{if(f.files){var b=f.files[0];c=b.fileSize;if(checkFileSize(c)){d=b.getAsDataURL();g.src=d;alert(d)}}else{if(l.filters){f.select();var m=document.selection.createRange().text;l.style.filter="progid:DXImageTransform.Microsoft.AlphaImageLoader(sizingMethod=scale)";l.filters.item("DXImageTransform.Microsoft.AlphaImageLoader").src=m;i.style.filter="progid:DXImageTransform.Microsoft.AlphaImageLoader(sizingMethod=scale)";i.filters.item("DXImageTransform.Microsoft.AlphaImageLoader").src=m;g.style.display="none";var h=setInterval(function(){var e=document.createElement("img");e.src=m;c=e.fileSize;if(c>0){checkFileSize(c);clearInterval(h)}e=null},100)}}}}catch(k){}}function checkFileSize(a){if(a>1024*1024*10){alert("您上传的文件大于10M,请重新选择！");return false}return true}function checkFileExt(a){if(!a.match(/.jpg|.jpeg|.gif|.png/i)){return false}return true}function autoSizePreview(a,d,b){var c=clacImgZoomParam(300,300,d,b)}function clacImgZoomParam(d,c,b,a){var e={width:b,height:a,top:0,left:0};if(b>d||a>c){rateWidth=b/d;rateHeight=a/c;if(rateWidth>rateHeight){e.width=d;e.height=a/rateWidth}else{e.width=b/rateHeight;e.height=c}}e.left=(d-e.width)/2;e.top=(c-e.height)/2;return e}function onPreviewLoad(a){autoSizePreview(a,a.offsetWidth,a.offsetHeight)}Date.prototype.format=function(f){var d=this.getFullYear(),e=this.getMonth()+1,b=this.getDate(),a=this.getHours(),g=this.getMinutes(),c=this.getSeconds();f=f||"yyyy-MM-dd hh:mm:ss";var h=function(i){if(i.toString().length>1){return i.toString()}else{return"0"+i.toString()}};return f.replace(/yyyy/,d).replace(/yy/,d.toString().substr(2,2)).replace(/MM/,h(e)).replace(/M/,e).replace(/dd/,h(b)).replace(/d/,b).replace(/hh/,h(a)).replace(/h/,a).replace(/mm/,h(g)).replace(/m/,g).replace(/ss/,h(c)).replace(/s/,c)};