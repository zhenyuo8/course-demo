$.widget("custom.catcomplete",$.ui.autocomplete,{_renderMenu:function(d,c){var b=this,a="";$.each(c,function(e,f){if(f.category!=a){d.append("<li class='ui-autocomplete-category'><img src='http://www.ku.com/image/star_level6.gif' />"+f.category+"</li>");a=f.category}b._renderItem(d,f)})},_renderItem:function(a,b){return $("<li></li>").data("item.autocomplete",b).append($("<a></a>").html(b.label)).appendTo(a)},search:function(g,a){g=g!=null?g:this.element.val();var e=g;var f=false;var c=e.length;var h=e.charAt(0);var i=e.charAt(c-1);var d=e.lastIndexOf(" ");var b=e.charAt(d+1);if(h=="@"){if(i!=" "&&b=="@"){f=true}}else{if(b=="@"){f=true}}if(!f){this.close();return}if((pos=g.lastIndexOf("@"))!=-1){g=g.substring(pos+1);if(g==""){g="--=--"}}this.term=this.element.val();if(g.length<this.options.minLength){return this.close(a)}clearTimeout(this.closing);if(this._trigger("search",a)===false){return}return this._search(g)}});$(function(){function b(e){return e.split(/,\s*/)}function d(e){return b(e).pop()}var a={},c;$("#content").catcomplete({minLength:1,source:function(g,e){var f=g.term;if(f in a){e(a[f]);return}c=$.getJSON(yyBaseurl+"/common/search/notice",g,function(i,h,j){a[f]=i;if(j===c){e($.ui.autocomplete.filter(i,d(f)))}})},focus:function(){return false},select:function(e,f){this.value=this.value.substring(0,this.value.lastIndexOf("@")+1)+f.item.value+" ";return false}}).bind("input.autocomplete",function(){$(this).trigger("keydown.autocomplete")}).bind("keydown",function(e){if(e.keyCode===$.ui.keyCode.TAB&&$(this).data("autocomplete").menu.active){e.preventDefault()}})});